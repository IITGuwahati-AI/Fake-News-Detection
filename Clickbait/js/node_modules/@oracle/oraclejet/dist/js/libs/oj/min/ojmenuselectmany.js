/**
 * @license
 * Copyright (c) 2014, 2019, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
define(["ojs/ojcomposite","jquery","ojs/ojcomponentcore","ojs/ojoption","ojs/ojdataprovider"],function(e,t){"use strict";function i(e){this._composite=e.element,this._properties=e.properties,this.disconnected=this._disconnected.bind(this),this.connected=this._connected.bind(this),this.propertyChanged=this._propertyChanged.bind(this),this.optionIdPrefix=[e.unique,"opt"].join("_"),this.handleAction=this._handleAction.bind(this),this.handleOptionMutations=this._handleOptionMutations.bind(this),this._composite.setAttribute("role","group"),this._properties.disabled&&this._composite.setAttribute("aria-disabled","true")}i.prototype._connected=function(e){this._addEventListener()},i.prototype._disconnected=function(e){this._removeEventListener()},i.prototype._propertyChanged=function(e){("external"===e.updatedFrom&&"value"===e.property||"external"===e.updatedFrom&&"disabled"===e.property||"external"===e.updatedFrom&&"options"===e.property)&&(this._handleOptionMutations(),"disabled"===e.property&&(this._properties.disabled?this._composite.setAttribute("aria-disabled","true"):this._composite.removeAttribute("aria-disabled")))},i.prototype._addEventListener=function(){this._optionMutations=new MutationObserver(this.handleOptionMutations),this._optionMutations.observe(this._composite,{attributes:!0,subtree:!0,attributeFilter:["role"]}),this._composite.addEventListener("ojAction",this.handleAction,!0)},i.prototype._removeEventListener=function(){if(this._composite.removeEventListener("ojAction",this.handleAction,!0),this._optionMutations){var e=this._optionMutations.takeRecords();e&&e.length>0&&this.handleOptionMutations(),this._optionMutations.disconnect(),delete this._optionMutations}},i.prototype._handleAction=function(e){var t=e.target,o=t.value;i._optionToggleChecked(t)?this._addValue(o):this._removeValue(o)},i.prototype._handleOptionMutations=function(){for(var e=this._properties.value,t=this._composite.querySelectorAll("oj-option"),o=0;o<t.length;o++){var s=t[o];if(s.classList.contains("oj-menu-item")){var r=s.value,n=e.indexOf(r)>-1;i._optionSetChecked(s,n),this._properties.disabled?i._optionSetDisabled(s,!0):i._optionSetDisabled(s,s.disabled)}}},i.prototype._addValue=function(e){var t=this._properties.value;if(t.indexOf(e)<0){var i=t.slice();i.push(e),this._properties.value=i}},i.prototype._removeValue=function(e){var t=this._properties.value,i=t.indexOf(e);if(i>-1){var o=t.slice();o.splice(i,1),this._properties.value=o}},i._optionToggleChecked=function(e){var t=!1,i=e.firstChild;if(i){var o=i.querySelector(".oj-menucheckbox-icon");"true"===i.getAttribute("aria-checked")?(i.setAttribute("aria-checked","false"),o&&o.classList.remove("oj-selected")):(i.setAttribute("aria-checked","true"),o&&o.classList.add("oj-selected")),t="true"===i.getAttribute("aria-checked")}return t},i._optionSetChecked=function(e,t){var i=e.firstChild;if(i){i.setAttribute("aria-checked",t?"true":"false");var o=i.querySelector(".oj-menucheckbox-icon");o&&(t?o.classList.add("oj-selected"):o.classList.remove("oj-selected"))}},i._optionSetDisabled=function(e,t){var i=e.firstChild;if(i){var o=i.querySelector(".oj-menucheckbox-icon");t?(e.classList.add("oj-disabled"),i.setAttribute("aria-disabled","true"),o&&o.classList.add("oj-disabled")):(e.classList.remove("oj-disabled"),i.removeAttribute("aria-disabled"),o&&o.classList.remove("oj-disabled"))}},e.register("oj-menu-select-many",{view:'<oj-bind-slot></oj-bind-slot><oj-bind-if test="[[$props.options]]">  <oj-bind-for-each data="[[$props.options]]">    <template>      <oj-option :id="[[$current.data.id ? $current.data.id : optionIdPrefix + $current.observableIndex()]]"                  value="[[$current.data.value]]" disabled="[[$current.data.disabled]]">        <oj-bind-text value="[[$current.data.label]]"></oj-bind-text>      </oj-option>    </template>  </oj-bind-for-each><oj-bind-if>',viewModel:i,metadata:{properties:{disabled:{type:"boolean",value:!1},options:{type:"Array<Object>|object"},value:{type:"Array<any>",writeback:!0,value:[]}},methods:{setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},extension:{}}})});