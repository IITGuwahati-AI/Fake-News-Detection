define(["./persistenceUtils"],function(a){"use strict";function b(a){if(!a||1!==a.length)throw new Error({message:"shredded data is not in the correct format."});var b=a[0].data;return b&&1===b.length&&"single"===a[0].resourceType?b[0]:b}var c=function(a){return function(b){var c=b.clone(),d=c.headers.get("Etag");return c.blob().then(function(c){var e=[],f=[];return e[0]=null==b.url||0==b.url.length?b.headers.get("x-oracle-jscpt-response-url"):b.url,f[0]=c,[{name:a,resourceIdentifier:d,keys:e,data:f,resourceType:"single"}]})}},d=function(){return function(c,d){var e=b(c);return a.setResponsePayload(d,e).then(function(a){return a.headers.set("x-oracle-jscpt-cache-expiration-date",""),Promise.resolve(a)})}};return{getShredder:c,getUnshredder:d}});