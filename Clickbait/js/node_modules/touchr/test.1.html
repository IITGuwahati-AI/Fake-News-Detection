<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    	<meta http-equiv="X-UA-Compatible" content="IE=10; IE=9; IE=8;" />
		<meta name="robots" content="index,follow" />
		<title>T</title>
		<script type="text/javascript" src="js/touchr.js"></script>
		<!-- <script type="text/javascript" src="http://aichi.github.io/Touchr/javascripts/touchr.js"></script> -->
		
		<!-- Modernizr.touch should be true -->
		<!-- script type="text/javascript" src="http://modernizr.com/downloads/modernizr-latest.js"></script-->
		<style type="text/css">
		html {
			overflow: hidden;
		}
		body {
			margin: 0;
			padding: 0;
			width: 100%;
			height: 100%;
			position: absolute;
			-ms-touch-action: none;
			touch-action: none;
		}
		/* content */
		#main {
			-ms-touch-action: pan-y;
			touch-action: pan-y;
		}
		div#content {
			position: absolute;
			top: 0;
			left: 0;
			height: 300px;
			overflow-y: scroll;
			background: #fff;
		}

		ul {
			list-style: none;
			width: 300px;
			padding: 0;
			margin: 0;
			background-color: #f02020;
		}

		ul li {
			width: 100%;
			display: block;
			padding: 9px 10px 5px 10px;
			border-bottom: 1px solid #E7E7E7;
			-webkit-box-sizing: border-box;
			box-sizing: border-box;
			text-decoration: none;
			font-family: Helvetica, Arial, sans-serif;
			font-size: 18px;
			font-weight: bold;
			color: #000;
			background-color: #fff;
			position: relative;
		}

		li:hover {
			background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#058cf5), color-stop(100%,#015ee6));
			background: -webkit-linear-gradient(top, #058cf5 0%,#015ee6 100%);
			background: linear-gradient(top, #058cf5 0%,#015ee6 100%);
			color: #fff;
		}

		li:after {
			content: "\003009";
			float: right;
			font-weight: bold;
			color: #808080;
			font-size: 13px;
			text-shadow: 1px 0 1px #808080;
		}

		li:hover:after {
			color: #fff;
			text-shadow: 1px 0 1px #fff;
		}
		/* Log window */
		#log {
			position: absolute;
			overflow: auto;
			width: 400px;
			height: 100%;
			left: 600px;
			font-family: Consolas;
			font-size: 12px;
		}

		#clear {
			position:absolute;
			left: 1050px;
		}

		#logHead {
			font-weight: bold;
		}
		#logContent {
			white-space: pre;
		}
		</style>

  	</head>
  	<body id="body">
		<div id="main">
			<div id="content">
				<ul>
					<li>a</li>
					<li>b</li>
					<li>c</li>
					<li>d</li>
					<li>e</li>
					<li>f</li>
					<li>g</li>
					<li>h</li>
					<li>i</li>
					<li>j</li>
					<li>k</li>
					<li>l</li>
					<li>m</li>
					<li>n</li>
					<li>o</li>
					<li>p</li>
					<li>r</li>
					<li>s</li>
					<li>t</li>
					<li>u</li>
					<li>v</li>
					<li>w</li>
					<li>x</li>
					<li>y</li>
					<li>z</li>
				</ul>
			</div>
		</div>
		<div id="log">
			<div id="logHead">type, touches#, changed#, [0]screenX/Y, [1]screenX/Y</div>
			<div id="logContent"></div>
		</div>

		<button id="clear" onclick="document.getElementById('logContent').innerHTML='';">Clear</button>

		<script type="text/javascript">
		  //logging
		  var logdiv = document.getElementById("logContent");

		  function log() {
			var txt = document.createTextNode(Array.prototype.join.call(arguments, ", ") + "\r\n");
			logdiv.insertBefore(txt, logdiv.firstChild);
		  }
		</script>


		<script type="text/javascript">
			function listener(e) {
				var len = e.touches ? e.touches.length : 0;
				log(
					e.type, 
					len ? len : 0, 
					e.changedTouches ? e.changedTouches.length : "-",
					e.target.nodeName+"#"+e.target.id, 
					len > 0 ? e.touches[0].screenX : "-", 
					len > 0 ? e.touches[0].screenY : "-",
					len > 1 ? e.touches[1].screenX : "-", 
					len > 1 ? e.touches[1].screenY : "-"
				);
			}

			// Triggering the events for this element
			var elm = document.getElementById("main");
			//elm = document.getElementById("body");
			//elm = document;

			elm.addEventListener("touchstart", listener, false);
			elm.addEventListener("touchmove", listener, false);
			elm.addEventListener("touchend", listener, false);
			
			elm.addEventListener("gesturestart", listener, false);
			elm.addEventListener("gesturechange", listener, false);
			elm.addEventListener("gestureend", listener, false);

			document.body.addEventListener('touchstart',function(e)
			{
				if (e.target.nodeName.toLowerCase() !== "li") {
					return;
				}
				e = e || window.event; //don't know how mobile browsers behave here
				var startCoordinates = {x:e.changedTouches[0].clientX,
										y:e.changedTouches[0].clientY};
				
				var diff = function(clientX) {
					return startCoordinates.x - clientX;
				};
				var moveHandler = function(e) {
					e = e || window.e;
					var xDiff = diff(e.changedTouches[0].clientX);
					xDiff = Math.max(xDiff, 0);
					xDiff = xDiff > 5 ? xDiff: 0;
					e.target.style.left = '-' + xDiff + 'px';
				};
				var endHandler = function(e) {
					e = e || window.e;
					var xDiff = diff(e.changedTouches[0].clientX);
					//unbind handler, avoid double listeners
					document.body.removeEventListener('touchend', endHandler, false);
					document.body.removeEventListener('touchmove', moveHandler, false);
					e.target.style.left = '0px';
				};
				document.body.addEventListener('touchmove', moveHandler, false);
				document.body.addEventListener('touchend', endHandler, false);
			},false);
		</script>
	</body>
</html>
