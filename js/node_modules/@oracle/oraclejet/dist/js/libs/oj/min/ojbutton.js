/**
 * @license
 * Copyright (c) 2014, 2019, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
define(["ojs/ojcore","jquery","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojchildmutationobserver","ojs/ojlabelledbyutils","ojs/ojoption"],function(e,t,n,o,s,i){"use strict";var a={properties:{chroming:{type:"string",enumValues:["full","half","outlined"]},disabled:{type:"boolean",value:!1},display:{type:"string",enumValues:["all","icons"],value:"all"},translations:{type:"object",value:{}}},methods:{refresh:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAction:{}},extension:{}},l={properties:{chroming:{type:"string",enumValues:["full","half","outlined"]},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},display:{type:"string",enumValues:["all","icons"],value:"all"},focusManagement:{type:"string",enumValues:["none","oneTabstop"],value:"oneTabstop"},labelledBy:{type:"string"},translations:{type:"object",value:{}},value:{type:"Array<any>",writeback:!0}},methods:{refresh:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},extension:{}},r={properties:{chroming:{type:"string",enumValues:["full","half","outlined"]},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},display:{type:"string",enumValues:["all","icons"],value:"all"},focusManagement:{type:"string",enumValues:["none","oneTabstop"],value:"oneTabstop"},labelledBy:{type:"string"},translations:{type:"object",value:{}},value:{type:"any",writeback:!0}},methods:{refresh:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},extension:{}},u={properties:{chroming:{type:"string",enumValues:["full","half","outlined"]},disabled:{type:"boolean",value:!1},display:{type:"string",enumValues:["all","icons"],value:"all"},translations:{type:"object",value:{}}},methods:{refresh:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAction:{}},extension:{}};!function(){var a,l,r="oj-button oj-component oj-enabled oj-default",u="oj-button-icons-only oj-button-icon-only oj-button-text-icons oj-button-text-icon-start oj-button-text-icon-end oj-button-text-only",c="oj-button-full-chrome oj-button-half-chrome oj-button-outlined-chrome",h={full:"oj-button-full-chrome",half:"oj-button-half-chrome",outlined:"oj-button-outlined-chrome"},d={button:["ojButtonset","ojToolbar"],buttonset:["ojToolbar"]};function m(e,t){_(e,c),e.classList.add(h[t])}function p(e,n){var o,s=e.name,i=e.form;if(s){var a=":radio[name='"+(s=s.replace(/'/g,"\\'"))+"']:oj-button";o=n?n.filter(a):i?t(i).find(a):t(a,e.ownerDocument).filter(function(){return!this.form})}else o=(n?n.filter(e):t(e)).filter(":oj-button");return o}function b(e,t,s){var i=function(e,t,n){for(var s=0;s<n.length;++s){var i=n[s];if(t.indexOf(i)>=0)for(;;e=e.parentNode){var a=o.__GetWidgetConstructor(e,i);if(a)return a}}return null}(t,s,d[e]);return i?i("option","chroming"):(n.parseJSONFromFontFamily("oj-"+e+"-option-defaults")||{}).chroming}function f(e,t){var n=e.className;if(n){for(var o=n.split(" "),s=t.split(" "),i=s.length;i>=0;i--)o.indexOf(s[i])>=0&&s.splice(i,1);s.length>0&&(e.className=n+" "+s.join(" "))}else e.className=t}function _(e,t){var n=e.className;if(n){for(var o=n.split(" "),s=t.split(" "),i=!1,a=0;a<s.length;a++){var l=o.indexOf(s[a]);l>=0&&(o.splice(l,1),i=!0)}i&&(e.className=o.join(" "))}}e.__registerWidget("oj.ojButton",t.oj.baseComponent,{defaultElement:"<button>",widgetEventPrefix:"oj",options:{chroming:"full",disabled:!1,display:"all",label:null,icons:{start:null,end:null},menu:null,action:null},_InitOptions:function(e,t){this._super(e,t),this._IsCustomElement()&&this._processSlots(),this._initButtonTypes(),this._IsCustomElement()||"disabled"in t||this.option("disabled",!!this.element[0].disabled,{_context:{internalSet:!0}}),"label"in t||(this.keepDomLabel=!0,this.option("label","inputPush"===this.type?this.buttonElement.val():this.buttonElement[0].innerHTML,{_context:{internalSet:!0}})),this._IsCustomElement()||!this.options.menu||t.icons&&void 0!==t.icons.end||this.option("icons.end","oj-component-icon oj-button-menu-dropdown-icon",{_context:{writeback:!0,internalSet:!0}})},_ComponentCreate:function(){this._super(),this.menuEventNamespace=this.eventNamespace+"menu",this._initButtonTypes2(),this.hasTitle=!!this.rootElement.getAttribute("title");var n=this,o=this._isToggle,s=o?"":"oj-active";f(this.rootElement,r),m(this.rootElement,this.options.chroming);var i=function(){s&&n.rootElement.classList.remove(s),n.rootElement.classList.remove("oj-hover"),n._toggleDefaultClasses()};if(e.DomUtils.isTouchSupported()&&this.buttonElement.bind("touchstart"+this.eventNamespace,function(){n._IsEffectivelyDisabled()||(s&&n.rootElement.classList.add(s),n._toggleDefaultClasses(),n.document.one("touchend",i))}).bind("touchend"+this.eventNamespace+" touchcancel"+this.eventNamespace,i),this.buttonElement.bind("mouseenter"+this.eventNamespace,function(){n._IsEffectivelyDisabled()||e.DomUtils.recentTouchEnd()||(this===a&&n.rootElement.classList.add("oj-active"),n.rootElement.classList.add("oj-hover"),n.rootElement.classList.remove("oj-default"),n.rootElement.classList.remove("oj-focus-only"))}).bind("mouseleave"+this.eventNamespace,function(){n.rootElement.classList.remove("oj-hover"),n._IsEffectivelyDisabled()||(s&&n.rootElement.classList.remove(s),n._toggleDefaultClasses())}),this._disabledClickHandler=function(e){n._IsEffectivelyDisabled()&&(e.preventDefault(),e.stopImmediatePropagation())},this._ojActionClickHandler=function(e){n._trigger("action",e,{})},this._IsCustomElement()?(this.rootElement.addEventListener("click",this._disabledClickHandler,!0),this.rootElement.addEventListener("click",this._ojActionClickHandler,!1)):this.buttonElement[0].addEventListener("click",this._disabledClickHandler,!0),this._focusable({element:t(this.rootElement),applyHighlight:!0,afterToggle:function(){n._toggleDefaultClasses()}}),o&&(this.element.bind("change"+this.eventNamespace,function(e){n._applyCheckedStateFromDom(!0);var t=n._getEnclosingContainerComponent("buttonset"),o=t&&t._getCheckedFromDom(t.$buttons);t&&void 0!==o&&t.option("checked",o,{_context:{writeback:!0,originalEvent:e,internalSet:!0}})}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(){n._IsEffectivelyDisabled()||(l=this,n.document.one("mouseup",function(){l=null}))}).bind("mouseup"+this.eventNamespace,function(){n._IsEffectivelyDisabled()||this===l&&n.element.focus()})),"checkbox"===this.type)this.buttonElement.bind("click"+this.eventNamespace,function(){if(n._IsEffectivelyDisabled())return!1}),this.element.bind("keyup"+this.eventNamespace,function(e){e.keyCode===t.ui.keyCode.ENTER&&(n._IsEffectivelyDisabled()||n.element.click())});else if("radio"===this.type)this.buttonElement.bind("click"+this.eventNamespace,function(){if(n._IsEffectivelyDisabled())return!1}),this.element.bind("keyup"+this.eventNamespace,function(e){e.keyCode===t.ui.keyCode.ENTER&&(n.element[0].checked||n._IsEffectivelyDisabled()||(n.element[0].checked=!0,n.element.change(),n.element.click()))});else if(this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){if(n._IsEffectivelyDisabled())return!1;1!==t.which||e.DomUtils.recentTouchEnd()||(n.rootElement.classList.add("oj-active"),n.rootElement.classList.remove("oj-default"),n.rootElement.classList.remove("oj-focus-only"),a=this,n.document.one("mouseup",function(){a=null}))}).bind("mouseup"+this.eventNamespace,function(){if(n._IsEffectivelyDisabled())return!1;n.rootElement.classList.remove("oj-active"),n._toggleDefaultClasses()}).bind("keydown"+this.eventNamespace,function(e){if(n._IsEffectivelyDisabled())return e.keyCode===t.ui.keyCode.TAB||e.keyCode===t.ui.keyCode.LEFT||e.keyCode===t.ui.keyCode.RIGHT;var o=e.keyCode===t.ui.keyCode.SPACE,s="anchor"===n.type;s&&o&&e.preventDefault(),(o&&!s||e.keyCode===t.ui.keyCode.ENTER)&&(n.rootElement.classList.add("oj-active"),n.rootElement.classList.remove("oj-default"),n.rootElement.classList.remove("oj-focus-only"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){n.rootElement.classList.remove("oj-active"),n._toggleDefaultClasses()}),"anchor"===this.type){var u=this.buttonElement[0].getAttribute("tabindex");(null===u||isNaN(u))&&this.buttonElement[0].setAttribute("tabindex","0")}this.options.disabled&&this._manageAnchorTabIndex(!1,!0),this._updateEffectivelyDisabled();var c=n._getEnclosingContainerComponent("buttonset");this._IsCustomElement()||c&&c._IsCustomElement()?this._setDisplayOptionOnDom():this._handleLabelAndIconsAtCreateTime(),this._setupMenuButton(null),this._toggleDefaultClasses(),this._childMutationObserver&&this._childMutationObserver.observe()},_NotifyContextMenuGesture:function(e,n,o){this._OpenContextMenu(n,o,{position:{of:"keyboard"===o?t(this.rootElement):n}})},_addMutationObserver:function(){if(!this._childMutationObserver&&this._IsCustomElement()){var e=this;this._childMutationObserver=new s(this.rootElement,function(t){t.forEach(function(t){var n;if("childList"===t.type){var o=t.addedNodes&&t.addedNodes[0],s=t.target;if(o&&3===o.nodeType&&s&&1===s.nodeType&&s.classList.contains("oj-button-label")){e._childMutationObserver.disconnect(),n=!0;var i=e.buttonElement[0].querySelector(".oj-button-text");i&&(i.textContent=o.textContent),o.parentNode.removeChild(o)}}else"characterData"===t.type&&(e._childMutationObserver.disconnect(),n=!0);n&&(e._setDisplayOptionOnDom(),e._childMutationObserver.observe())})})}},_removeMutationObserver:function(){this._childMutationObserver&&(this._childMutationObserver.disconnect(),this._childMutationObserver=null)},_processSlots:function(){var n,o=this,s=this.element[0],i=s.parentNode,a="OJ-MENU-BUTTON"===i.tagName,l=e.BaseCustomElementBridge.getSlotMap(i);n=a?["startIcon","","endIcon","menu"]:["startIcon","","endIcon"],t.each(n,function(e,n){l[n]&&""!==n&&t.each(l[n],function(e,t){s.appendChild(t)})});for(var r=i.children,u=r.length-1;u>=0;u--){var c=r[u];c!==s&&"contextMenu"!==c.getAttribute("slot")&&i.removeChild(c)}var h=e.BaseCustomElementBridge.getSlotMap(s);t.each(n,function(e,n){h[n]&&t.each(h[n],function(e,i){if(s.appendChild(i),""===n){var a=i,l=a;3===a.nodeType&&(l=document.createElement("span"),a.parentNode.insertBefore(l,a),l.appendChild(a)),l.classList.add("oj-button-text"),o._setTextSpanIdAndLabelledBy(l)}else if("startIcon"===n)i.classList.add("oj-button-icon"),i.classList.add("oj-start");else if("endIcon"===n)i.classList.add("oj-button-icon"),i.classList.add("oj-end");else if("menu"===n&&(t(i).uniqueId(),o.menuSlot="#"+i.id,void 0===h.endIcon)){var r=document.createElement("span");r.className="oj-button-icon oj-end oj-component-icon oj-button-menu-dropdown-icon",r.setAttribute("slot","endIcon"),s.insertBefore(r,i)}})});var d=document.createElement("div");for(d.className="oj-button-label";s.hasChildNodes();)d.appendChild(s.firstChild);s.appendChild(d)},_getMenuNode:function(){return this._IsCustomElement()?this.menuSlot:this.options.menu},_initButtonTypes:function(){var e=this.element[0];if("INPUT"===e.tagName&&"checkbox"===e.type)this.type="checkbox",this._isToggle=!0;else if("INPUT"===e.tagName&&"radio"===e.type)this.type="radio",this._isToggle=!0;else if("INPUT"!==e.tagName||"button"!==e.type&&"submit"!==e.type&&"reset"!==e.type)if("BUTTON"===e.tagName)this.type="button";else{if("A"!==e.tagName)throw new Error("JET Button not supported on this element type");this.type="anchor"}else this.type="inputPush";if(this._isToggle){var t="label[for='"+this.element[0].getAttribute("id")+"']";this.buttonElement=this.element.siblings().filter(t)}else this.buttonElement=this.element},_initButtonTypes2:function(){var e=this.element[0];if(this._isToggle){this.buttonElement[0].classList.add("oj-button-label"),e.classList.add("oj-button-input"),e.classList.add("oj-helper-hidden-accessible"),e.setAttribute("data-oj-internal","");var t=document.createElement("span");this.element[0].parentNode.insertBefore(t,this.buttonElement[0]),t.appendChild(this.buttonElement[0]),t.appendChild(this.element[0]),this.rootElement=this.element[0].parentNode,this.rootElement.classList.add("oj-button-jqui"),this.rootElement.classList.add("oj-button-toggle"),e.checked&&(this.rootElement.classList.add("oj-selected"),this.rootElement.classList.remove("oj-default"),this.rootElement.classList.remove("oj-focus-only"))}else this._IsCustomElement()?(this.rootElement=this.element[0].parentNode,e.classList.add("oj-button-button")):(this.rootElement=this.element[0],e.classList.add("oj-button-jqui"))},widget:function(){return t(this.rootElement)},_destroy:function(){this._removeMenuBehavior(this._getMenuNode()),this.buttonElement[0].removeEventListener("click",this._disabledClickHandler,!0),this.buttonElement[0].removeEventListener("click",this._ojActionClickHandler,!1);var t=this.element[0];t.classList.remove("oj-helper-hidden-accessible"),t.removeAttribute("aria-labelledby"),this.element.removeUniqueId(),this.options.disabled&&this._manageAnchorTabIndex(!0,!1);var n=this._isToggle;n||_(this.rootElement,r+" oj-button-jqui oj-hover oj-active oj-selected "+u+" "+c);var o=this.buttonElement[0].querySelector(".oj-button-text");o&&(this.buttonElement[0].innerHTML=o.innerHTML),n?(this.buttonElement[0].classList.remove("oj-button-label"),e.DomUtils.unwrap(this.element)):this.hasTitle||this.rootElement.removeAttribute("title"),l===this.buttonElement[0]&&(l=null),this.buttonElement.off("blur"),this._removeMutationObserver()},_NotifyDetached:function(){this._super(),this._toggleDefaultClasses()},__setAncestorComponentDisabled:function(e){this._super(e),this._updateEffectivelyDisabled()},_updateEffectivelyDisabled:function(){var e=this.element[0],t=this._IsEffectivelyDisabled();if(t?(this.rootElement.classList.add("oj-disabled"),this.rootElement.classList.remove("oj-enabled")):(this.rootElement.classList.remove("oj-disabled"),this.rootElement.classList.add("oj-enabled")),"anchor"!==this.type?(e.disabled=t,this.rootElement.removeAttribute("aria-disabled")):(e.setAttribute("aria-disabled",t),this._IsCustomElement()&&this.rootElement.removeAttribute("aria-disabled")),t){var n=this.widget()[0].classList;n.remove("oj-active"),n.remove("oj-default"),n.remove("oj-focus-only"),n.remove("oj-hover"),n.remove("oj-focus"),n.remove("oj-focus-highlight"),a=null,this._dismissMenu(this._getMenuNode())}else this._toggleDefaultClasses()},_setOption:function(e,t,n){var o=this.options[e];switch(this._super(e,t,n),e){case"chroming":m(this.rootElement,t);break;case"disabled":this._manageAnchorTabIndex(o,t),this._updateEffectivelyDisabled();var s=this._getEnclosingContainerElement("toolbar");s.length&&(this._IsCustomElement()?s[0].refresh():s.ojToolbar("refresh"));break;case"label":this._setLabelOption();break;case"display":"inputPush"!==this.type&&this._setDisplayOptionOnDom();break;case"icons":this._setIconsOption(!0);break;case"menu":this._setupMenuButton(o)}},refresh:function(){this._super(),this._ancestorDisabled&&!this._getEnclosingContainerElement("buttonset").length&&this.__setAncestorComponentDisabled(!1),m(this.rootElement,this.options.chroming)},_applyCheckedStateFromDom:function(e){"radio"===this.type?(e?p(this.element[0]):this.element).each(function(){var e=t(this).data("oj-ojButton");this.checked?(e.rootElement.classList.add("oj-selected"),e.rootElement.classList.remove("oj-default"),e.rootElement.classList.remove("oj-focus-only")):(e.rootElement.classList.remove("oj-selected"),e._toggleDefaultClasses())}):"checkbox"===this.type&&(this.element[0].checked?(this.rootElement.classList.add("oj-selected"),this.rootElement.classList.remove("oj-default"),this.rootElement.classList.remove("oj-focus-only")):(this.rootElement.classList.remove("oj-selected"),this._toggleDefaultClasses()))},_handleLabelAndIconsAtCreateTime:function(){if("inputPush"===this.type)this._setLabelOnDomOfSpanlessButton();else{var e=this._setLabelOnDomAtCreateTime(),t=this._setIconOnDom(!0),n=this._setIconOnDom(!1);this._setDisplayOptionOnDom(e,t,n)}},_setLabelOnDomAtCreateTime:function(){var e=this.buttonElement[0],n=document.createElement("span");if(n.className="oj-button-text",this.keepDomLabel)for(;e.hasChildNodes();)n.appendChild(e.firstChild);else e.innerHTML="",n.textContent=this.options.label;if("button"===this.type){var o=document.createElement("div");o.className="oj-button-label",o.appendChild(n),this.element[0].appendChild(o)}else e.appendChild(n);return"button"!==this.type&&"anchor"!==this.type||this.element[0].hasAttribute("aria-label")||this.element[0].hasAttribute("aria-labelledby")||this._setTextSpanIdAndLabelledBy(n),t(n)},_setTextSpanIdAndLabelledBy:function(e){t(e).uniqueId(),this.element[0].setAttribute("aria-labelledby",e.getAttribute("id"))},_setLabelOption:function(){if("inputPush"===this.type)this._setLabelOnDomOfSpanlessButton();else{var e=this.buttonElement[0].querySelector(".oj-button-text");e.textContent=this.options.label,this._setDisplayOptionOnDom(t(e))}},_setLabelOnDomOfSpanlessButton:function(){this.options.label&&this.element.val(this.options.label)},_setIconsOption:function(){if("inputPush"!==this.type){var e=this._setIconOnDom(!0),t=this._setIconOnDom(!1);this._setDisplayOptionOnDom(void 0,e,t)}},_setIconOnDom:function(e){var t,n,o,s,i=this.buttonElement[0];"button"===this.type&&(i=this.element.children("div.oj-button-label")[0]),e?(t=".oj-button-icon.oj-start",n="oj-button-icon oj-start",o=this.options.icons.start,s="_lastStartIcon"):(t=".oj-button-icon.oj-end",n="oj-button-icon oj-end",o=this.options.icons.end,s="_lastEndIcon");var a,l,r=i.querySelectorAll(t);if(o)if(r.length){var u=this[s];for(a=0;a<r.length;a++)_(l=r[a],u),f(l,o)}else{var c=document.createElement("span");c.className=n+" "+o,e?i.insertBefore(c,i.firstChild):i.appendChild(c)}else for(a=0;a<r.length;a++)(l=r[a]).parentNode.removeChild(l);return this[s]=o,!!o},_setDisplayOptionOnDom:function(e,n,o){var s=this.buttonElement.children(".oj-button-label");if(!s.length){var i=this._getEnclosingContainerComponent("buttonset");s=this._IsCustomElement()||i&&i._IsCustomElement()?this.buttonElement.children("oj-option"):this.buttonElement}void 0===e&&(e=s.children(".oj-button-text")),void 0===n&&(n=!!this.options.icons.start||s.children("[slot='startIcon']").length),void 0===o&&(o=!!this.options.icons.end||s.children("[slot='endIcon']").length);var a,l=n&&o,r=n||o,c="icons"===this.options.display;if(r&&c){if(e[0]&&e[0].classList.add("oj-helper-hidden-accessible"),!this.hasTitle){var h=e[0]?e[0].textContent:"";this.rootElement.setAttribute("title",t.trim(h))}this._addMutationObserver()}else e[0]&&e[0].classList.remove("oj-helper-hidden-accessible"),this.hasTitle||this.rootElement.removeAttribute("title"),this._removeMutationObserver();a=r?c?l?"oj-button-icons-only":"oj-button-icon-only":l?"oj-button-text-icons":n?"oj-button-text-icon-start":"oj-button-text-icon-end":"oj-button-text-only",_(this.rootElement,u),this.rootElement.classList.add(a)},_manageAnchorTabIndex:function(e,t){if(!e!=!t&&"anchor"===this.type&&!this._getEnclosingContainerElement("buttonset").length&&!this._getEnclosingContainerElement("toolbar").length){var n=this.element[0];if(t){var o=n.getAttribute("tabindex");this._oldAnchorTabIndex=this._isInteger(Number(o))?o:null,n.setAttribute("tabindex",-1)}else null==this._oldAnchorTabIndex?n.removeAttribute("tabindex"):n.setAttribute("tabindex",this._oldAnchorTabIndex)}},_isInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},_selectorMap:{buttonset:".oj-buttonset",toolbar:".oj-toolbar"},_constructorMap:{buttonset:"ojButtonset",toolbar:"ojToolbar"},_getEnclosingContainerElement:function(e){return t(this.rootElement).closest(this._selectorMap[e])},_getEnclosingContainerComponent:function(e){var t=this._getEnclosingContainerElement(e)[0],n=o.__GetWidgetConstructor(t,this._constructorMap[e]);return n&&n("instance")},_setupMenuButton:function(e){if(this._getMenuNode()&&"INPUT"===this.element[0].tagName)throw new Error("Menu Button functionality is not supported on input elements.");if(this._removeMenuBehavior(e),this._getMenuNode()){var n=this;this.element.attr("aria-haspopup",!0).on("keydown"+this.menuEventNamespace,function(e){if(e.which===t.ui.keyCode.DOWN)return n._showMenu(e,"firstItem"),e.preventDefault(),!0;if(e.which===t.ui.keyCode.ESCAPE){var o=!n.rootElement.classList.contains("oj-selected");return n._dismissMenu(n._getMenuNode(),e),o}return!0}).on("click"+this.menuEventNamespace,function(e){var t=n._getMenu();return t.__spaceEnterDownInMenu||n._showMenu(e,"firstItem"),t.__spaceEnterDownInMenu=!1,e.preventDefault(),!0})}},_removeMenuBehavior:function(e){this.element.removeAttr("aria-haspopup").off(this.menuEventNamespace),this._dismissMenu(e),t(e).off(this.menuEventNamespace),this._menuListenerSet=!1},_getMenu:function(){var e=this._getMenuOnly(this._getMenuNode());if(!e)throw new Error('JET Button: "menu" option specified, but does not reference a valid JET Menu.');if(!this._menuListenerSet){var t,n=this;t=e._IsCustomElement()?"ojClose":"ojclose",e.widget().on(t+this.menuEventNamespace,function(e){n._menuDismissHandler(e)}),this._menuListenerSet=!0}return e},_getMenuOnly:function(e){var n=o.__GetWidgetConstructor(t(e)[0],"ojMenu");return n&&n("instance")},_showMenu:function(e,t){if(!this._IsEffectivelyDisabled()){var n=this._getMenu(),o=n.widget();n.open(e,{launcher:this.element,initialFocus:t}),o.is(":visible")&&(this._menuVisible=!0,o[0].getAttribute("aria-label")||o[0].getAttribute("aria-labelledby")||(this.element.uniqueId(),this._setAriaLabelledBy=!0,o[0].setAttribute("aria-labelledby",this.element[0].getAttribute("id"))),this.rootElement.classList.add("oj-selected"),this.rootElement.classList.remove("oj-default"),this.rootElement.classList.remove("oj-focus-only"))}},_dismissMenu:function(e,t){if(this._menuVisible){var n=this._getMenuOnly(e);n&&(n.__collapseAll(t,!0),n.__dismiss(t))}},_menuDismissHandler:function(){this._setAriaLabelledBy&&(t(this._getMenuNode()).removeAttr("aria-labelledby"),this._setAriaLabelledBy=!1),this.rootElement.classList.remove("oj-selected"),this._toggleDefaultClasses(),this._menuVisible=!1},_toggleDefaultClasses:function(){var e,n;if(t(this.rootElement).is(".oj-hover, .oj-active, .oj-selected, .oj-disabled"))e=!1,n=!1;else{var o=t(this.rootElement).is(".oj-focus");e=!o,n=o}e?this.rootElement.classList.add("oj-default"):this.rootElement.classList.remove("oj-default"),n?this.rootElement.classList.add("oj-focus-only"):this.rootElement.classList.remove("oj-focus-only")}}),e.__registerWidget("oj.ojButtonset",t.oj.baseComponent,{_items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a",widgetEventPrefix:"oj",options:{checked:null,chroming:"full",display:"all",focusManagement:"oneTabstop",labelledBy:null,describedBy:null},_setCheckedOnDom:function(e,n){var o,s=t.type(e),i=this.element[0];if((o="OJ-BUTTONSET-MANY"===i.tagName||n.length>0&&n.filter("input[type=checkbox]").length===n.length)&&"array"!==s)throw new Error("Invalid 'checked' value set on JET Buttonset: "+e);if(!(this._setCheckedOnButtons(e,n,s,o)||null===e||this._IsCustomElement()&&n.length!==i.children.length))throw new Error("Invalid 'checked' value set on JET Buttonset: "+e)},_setCheckedOnButtons:function(e,t,n,o){var s=this._shallowCompare(e,t,o);return this._shouldDeepCompare(e,o,s)&&(s=this._deepCompare(e,t,o,s)),o?s===e.length:1===s},_shallowCompare:function(e,t,n){var o=this,s=0;return t.each(function(){var t=o._getInputValue(this);(n?e.indexOf(t)>-1:t===e)?(this.checked=!0,s+=1):this.checked=!1}),s},_shouldDeepCompare:function(e,t,n){return t?n!==e.length:!n},_deepCompare:function(e,t,n,o){var s=o,i=this;return t.each(function(){var t=i._getInputValue(this);if(n)for(var o=0;o<e.length;o++)i._deepCompareValues(t,e[o])&&(this.checked=!0,s+=1);else i._deepCompareValues(t,e)&&(this.checked=!0,s+=1)}),s},_deepCompareValues:function(n,o){return"object"===t.type(n)&&n.ojCompareValues?0===n.ojCompareValues(n,o):e.Object.compareValues(n,o)},_getInputValue:function(e){return this._IsCustomElement()?this._getOjOptionFromInput(e).value:e.value},_getOjOptionFromInput:function(e){return e.previousElementSibling.children[0]},_getCheckedFromDom:function(e){var t,n=null,o=null,s=this;return e.each(function(){if("input"!==this.tagName.toLowerCase())return t=void 0,!1;var e,i,a=this.type.toLowerCase();if("radio"===a)e=!0,i=this.name.toLowerCase();else{if("checkbox"!==a)return t=void 0,!1;e=!1,i=null}if(void 0!==t&&(e!==n||i!==o||n&&!o))return t=void 0,!1;var l=s._getInputValue(this);void 0===t?(t=e?this.checked?l:null:this.checked?[l]:[],n=e,o=i):this.checked&&(n?t=l:t.push(l))}),t},_CompareOptionValues:function(e,n,o){return"checked"===e?n===o||"array"===t.type(n)&&"array"===t.type(o)&&this._compareArraysAsSets(n,o):this._superApply(arguments)},_compareArraysAsSets:function(e,t){return!e.some(function(e){return t.indexOf(e)<0})&&!t.some(function(t){return e.indexOf(t)<0})},_removeNonOjOptions:function(){this.element.children(":not(oj-option)").remove()},_processOjOptions:function(){var e=this,n=this.element[0].querySelectorAll("oj-option");t.each(n,function(t,n){n.customOptionRenderer=e._customOptionRenderer.bind(e)})},_customOptionRenderer:function(e){this._removeOptionDecoration(e),this._addOptionDecoration(e)},_addOptionDecoration:function(e){this._addOptionClasses(e);var n="OJ-BUTTONSET-ONE"===this.element[0].tagName,o=n?"radio":"checkbox",s=e.value,i=e.disabled,a=document.createElement("input"),l=document.createElement("label");t(a).uniqueId(),a.value=s,a.type=o,a.disabled=i;var r=a.id;l.htmlFor=r,n&&(this._name||(this._name="_n_"+r),a.name=this._name),e.parentNode.insertBefore(l,e),l.appendChild(e),l.parentNode.insertBefore(a,l.nextElementSibling),this._setup(!1),this._setCheckedOnDom(this.options.checked,this.$buttons),this.$buttons.each(function(){t(this).data("oj-ojButton")._applyCheckedStateFromDom(!1)})},_removeOptionDecoration:function(e){var n=e.parentNode;if("LABEL"===n.tagName){this._removeOptionClasses(e);var o=t(n).siblings(".oj-button-input");o.ojButton("destroy"),o.removeUniqueId(),o.remove(),n.parentNode.insertBefore(e,n),n.parentNode.removeChild(n)}},_addOptionClasses:function(t){var n=e.BaseCustomElementBridge.getSlotMap(t),o=n[""]?n[""]:null,s=n.startIcon?n.startIcon[0]:null,i=n.endIcon?n.endIcon[0]:null;if(s&&(s.classList.add("oj-button-icon"),s.classList.add("oj-start")),o)for(var a=0;a<o.length;a++){var l=o[a],r=l;3===l.nodeType&&(r=document.createElement("span"),l.parentNode.insertBefore(r,l),r.appendChild(l)),r.classList.add("oj-button-text")}i&&(i.classList.add("oj-button-icon"),i.classList.add("oj-end"))},_removeOptionClasses:function(t){var n=e.BaseCustomElementBridge.getSlotMap(t),o=n[""]?n[""]:null,s=n.startIcon?n.startIcon[0]:null,i=n.endIcon?n.endIcon[0]:null;if(s&&(s.classList.remove("oj-button-icon"),s.classList.remove("oj-start")),o)for(var a=0;a<o.length;a++)o[a].classList.remove("oj-button-text");i&&(i.classList.remove("oj-button-icon"),i.classList.remove("oj-end"))},_InitOptions:function(e,n){if(this._super(e,n),this.$buttons=this.element.find(this._items),!("checked"in n)){this.initCheckedFromDom=!0;var o=this._getCheckedFromDom(this.$buttons);"array"!==t.type(o)&&"OJ-BUTTONSET-MANY"!==this.element[0].tagName||(this.options.checked=[]),void 0!==o&&this.option("checked",o,{_context:{internalSet:!0}})}},_ComponentCreate:function(){this._super();var e=this.element[0];e.setAttribute(o._OJ_CONTAINER_ATTR,this.widgetName),e.classList.add("oj-buttonset"),e.classList.add("oj-component"),this._setRole(this.options.focusManagement),this._IsCustomElement()&&(this._removeNonOjOptions(),this._processOjOptions()),this._setup(!0)},_NotifyContextMenuGesture:function(e,t,n){var o=this.element.find(":oj-button[tabindex=0]");this._OpenContextMenu(t,n,{launcher:o,position:{of:"keyboard"===n?o.ojButton("widget"):t}})},_propagateDisabled:function(e){var n=!!e;this.$buttons.each(function(){t(this).data("oj-ojButton").__setAncestorComponentDisabled(n)})},_setRole:function(e){var t=this.element[0];"oneTabstop"===e?t.setAttribute("role","toolbar"):t.removeAttribute("role")},_setOption:function(e,n,o){var s=this.options[e];if(this._superApply(arguments),"disabled"===e)this._propagateDisabled(n),this._refreshTabStop();else if("checked"===e)this._setCheckedOnDom(n,this.$buttons),this.$buttons.each(function(){t(this).data("oj-ojButton")._applyCheckedStateFromDom(!1)});else if("focusManagement"===e)this._setRole(n);else if("chroming"===e)m(this.element[0],n),this.$buttons.ojButton("refresh");else if("display"===e)this.$buttons.ojButton("option",e,n);else if("labelledBy"===e){var i=this.element;this._updateLabelledBy(i[0],s,n,i)}else"describedBy"===e&&this._updateDescribedBy(s,n)},refresh:function(){this._super(),this._IsCustomElement()&&this._processOjOptions(),this._setup(!1)},_setup:function(e){var n=this,o=this.element[0];this.isRtl="rtl"===this._GetReadingDirection(),m(o,this.options.chroming),!e||this.initCheckedFromDom||this._IsCustomElement()||this._setCheckedOnDom(this.options.checked,this.$buttons),e||(this.$buttons=this.element.find(this._items)),this.$buttons.length>1?o.classList.add("oj-buttonset-multi"):o.classList.remove("oj-buttonset-multi"),this.$buttons.filter(":oj-button").ojButton("refresh").each(function(){t(this).data("oj-ojButton")._applyCheckedStateFromDom(!1)}).end().not(":oj-button").ojButton({display:this.options.display}).end();for(var s=0,i=this.$buttons.length;s<i;s++){var a=this.$buttons.eq(s).ojButton("widget")[0];a.classList.remove("oj-buttonset-first"),a.classList.remove("oj-buttonset-last"),0===s?a.classList.add("oj-buttonset-first"):s===i-1&&a.classList.add("oj-buttonset-last")}this._propagateDisabled(this.options.disabled),"oneTabstop"===this.options.focusManagement&&(this.$buttons.unbind("keydown"+this.eventNamespace).bind("keydown"+this.eventNamespace,function(e){n._handleKeyDown(e,t(this))}).unbind("click"+this.eventNamespace).bind("click"+this.eventNamespace,function(){t(this).data("oj-ojButton")._IsEffectivelyDisabled()||n._setTabStop(t(this))}).unbind("focus"+this.eventNamespace).bind("focus"+this.eventNamespace,function(){n._setTabStop(t(this))}),this.$enabledButtons=this.$buttons.filter(function(){return!t(this).data("oj-ojButton")._IsEffectivelyDisabled()}),this._initTabindexes(e)),this.element.uniqueId(),this._updateLabelledBy(o,null,this.options.labelledBy,this.element);var l=this.options.describedBy;if(l)for(var r=l.split(/\s+/),u=0;u<r.length;u++)this._addAriaDescribedBy(r[u])},_updateLabelledBy:i._updateLabelledBy,_addAriaDescribedBy:i._addAriaDescribedBy,_updateDescribedBy:i._updateDescribedBy,_removeAriaDescribedBy:i._removeAriaDescribedBy,_GetContentElement:function(){return null!=this.$buttons?this.$buttons:(this.$buttons=this.element.find(this._items),this.$buttons)},_refreshTabStop:function(){"oneTabstop"===this.options.focusManagement&&(this.$enabledButtons=this.$buttons.filter(function(){return!t(this).data("oj-ojButton")._IsEffectivelyDisabled()}),this._initTabindexes(!1))},_initTabindexes:function(e){var n,o=t(this._lastTabStop);this._lastTabStop=void 0,this.$buttons.attr("tabindex","-1"),n=e||!o.is(this.$enabledButtons)?this.$enabledButtons.first():o,this._setTabStop(n)},_mapToTabbable:function(e){var t=this.$enabledButtons;return e.map(function(e,n){if("radio"!==n.type||n.checked||""===n.name)return n;var o=p(n,t).filter(":checked");return o.length?o[0]:n})},_setTabStop:function(e){var t=(e=this._mapToTabbable(e))[0],n=this._lastTabStop;t!==n&&(n&&n.setAttribute("tabindex","-1"),e[0]&&e[0].setAttribute("tabindex","0"),this._lastTabStop=t)},_handleKeyDown:function(e,n){switch(e.which){case t.ui.keyCode.UP:case t.ui.keyCode.DOWN:if("radio"!==n[0].getAttribute("type"))break;case t.ui.keyCode.LEFT:case t.ui.keyCode.RIGHT:e.preventDefault();var o=this.$enabledButtons,s=o.length;if(s<2)break;var i=(o.index(n)+(e.which===t.ui.keyCode.DOWN||e.which===t.ui.keyCode.RIGHT!==this.isRtl?1:-1)+s)%s;o.eq(i).focus()}},_destroy:function(){var e=this.element[0];_(e,"oj-buttonset oj-component "+c),e.removeAttribute(o._OJ_CONTAINER_ATTR),e.removeAttribute("role"),"oneTabstop"===this.options.focusManagement&&this.$buttons.attr("tabindex","0"),this.$buttons.map(function(){return t(this).ojButton("widget")[0]}).removeClass("oj-buttonset-first oj-buttonset-last").end().ojButton("destroy")}}),o.setDefaultOptions({ojButton:{chroming:o.createDynamicPropertyGetter(function(e){return b("button",e.element,e.containers)})},ojButtonset:{chroming:o.createDynamicPropertyGetter(function(e){return b("buttonset",e.element,e.containers)})}})}(),a.extension._WIDGET_NAME="ojButton",a.extension._TRACK_CHILDREN="nearestCustomElement",a.extension._GLOBAL_TRANSFER_ATTRS=["href"],e.CustomElementBridge.register("oj-button",{metadata:a,innerDomFunction:function(e){return e.getAttribute("href")?"a":"button"}}),u.extension._WIDGET_NAME="ojButton",u.extension._TRACK_CHILDREN="nearestCustomElement",u.extension._GLOBAL_TRANSFER_ATTRS=["href"],e.CustomElementBridge.register("oj-menu-button",{metadata:u,innerDomFunction:function(e){return e.getAttribute("href")?"a":"button"}}),r.extension._WIDGET_NAME="ojButtonset",r.extension._ALIASED_PROPS={value:"checked"},e.CustomElementBridge.register("oj-buttonset-one",{metadata:r}),l.extension._WIDGET_NAME="ojButtonset",l.extension._ALIASED_PROPS={value:"checked"},e.CustomElementBridge.register("oj-buttonset-many",{metadata:l})});